!function(e){function n(s){if(t[s])return t[s].exports;var r=t[s]={exports:{},id:s,loaded:!1};return e[s].call(r.exports,r,r.exports,n),r.loaded=!0,r.exports}var t={};return n.m=e,n.c=t,n.p="",n(0)}([function(e,n,t){e.exports=t(1)},function(e,n){"use strict";function t(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function e(e,n){for(var t=0;t<n.length;t++){var s=n[t];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(n,t,s){return t&&e(n.prototype,t),s&&e(n,s),n}}(),r=function(){},o=function(){function e(n,s,r,o){var a=this;t(this,e),this.handlers={},this.connected=!1,this.socket=new WebSocket(n),this.socket.onopen=function(e){a.connected=!0,s(e)},this.socket.onclose=function(e){a.connected=!1,a.handlers={},a.socket=null,r(e)},this.socket.onerror=function(e){a.socket.close(),o(e)},this.socket.onmessage=function(e){a.handleMessage(e)}}return s(e,[{key:"onMessage",value:function(e){}},{key:"subscribeBlocks",value:function(e,n){return this.sendSubscription("subscribe.block",[],e,n)}},{key:"subscribeTransactions",value:function(e,n){return this.sendSubscription("subscribe.transaction",[],e,n)}},{key:"subscribeHeartbeats",value:function(e,n){return this.sendSubscription("subscribe.heartbeat",[],e,n)}},{key:"fetchLastHeight",value:function(e){return this.sendRequest("blockchain.last_height",[])}},{key:"fetchBlockHeader",value:function(e){return this.sendRequest("blockchain.block_header",{height:e})}},{key:"fetchBlockHeight",value:function(e){return this.sendRequest("blockchain.block_height",{hash:e})}},{key:"fetchBlockTransactionHashes",value:function(e){return this.sendRequest("blockchain.block_transaction_hashes",{hash:e})}},{key:"fetchTransactionIndex",value:function(e){return this.sendRequest("blockchain.transaction_index",{hash:e})}},{key:"fetchBlockchainTransaction",value:function(e){return this.sendRequest("blockchain.transaction",{hash:e})}},{key:"fetchTransactionPoolTransaction",value:function(e){return this.sendRequest("transaction_pool.transaction",{hash:e})}},{key:"fetchAddressHistory2",value:function(e,n){return this.sendRequest("address.history2",{address:e,count:n})}},{key:"fetchBlockchainHistory",value:function(){var e=arguments.length<=0||void 0===arguments[0]?null:arguments[0];return this.sendRequest("blockchain.history",{address:e})}},{key:"fetchTotalConnections",value:function(){return this.sendRequest("protocol.total_connections",{})}},{key:"sendSubscription",value:function(e,n){var t=arguments.length<=2||void 0===arguments[2]?r:arguments[2],s=arguments.length<=3||void 0===arguments[3]?r:arguments[3],o=e,a=JSON.stringify({id:o,command:e,params:n});return this.socket.send(a),this.handlers[o]={resolve:t,reject:s}}},{key:"sendRequest",value:function(e,n){var t=this,s=arguments.length<=2||void 0===arguments[2]?this.randomInteger():arguments[2],r=JSON.stringify({id:s,command:e,params:n});return this.socket.send(r),new Promise(function(e,n){t.handlers[s]={resolve:e,reject:n}})}},{key:"handleMessage",value:function(e){var n=JSON.parse(e.data);this.onMessage(n);var t=this.handlers[n.id];t&&(n.error?t.reject(n.error):n.result?t.resolve(n.result):console&&console.error(n),/^subscribe\./.test(n.id)||delete this.handlers[n.id])}},{key:"randomInteger",value:function(){return Math.floor(4294967296*Math.random())}}]),e}();n["default"]=o,e.exports=n["default"]}]);